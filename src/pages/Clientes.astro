---
const data = Astro.locals;
import { verify, userinfo } from "@Lib/auth";
export const prerender = false;
import Layout from "@Layouts/layout.astro";
import Sidebar from "@components/Sidebar.astro";
import Card from "@components/menu/Card.astro";

if ((await verify(data.token?.value)) == false) {
    return new Response(null, {
        status: 302,
        headers: {
            Location: "/",
        },
    });
}
const token = data.token?.value;
const res = await userinfo(token);
const user = res[0];
---

<Layout title="Panel de Control">
    <script>
        document.getElementById("add").addEventListener("click", function () {
            // Cambia la URL por la dirección a la que quieres redirigir
            window.location.href = "/add";
        });
        document
            .getElementById("editButton")
            .addEventListener("click", function () {
                // Cambia la URL por la dirección a la que quieres redirigir
                window.location.href = "/edit";
            });
    </script>
    <div
        class="flex flex-col md:flex-row xl:flex-row bg-gray-100 h-screen dark:bg-gray-800 dark:text-white"
    >
        <!-- Sidebar -->
        <Sidebar tipo={user.tipo_perfil}>
            <div class="flex-1 p-4 md:p-6 bg-gray-100 dark:bg-gray-800">
                <h1 class="text-3xl font-bold mb-6">
                    <i class="fa-solid fa-address-book"></i> Listado de Clientes
                </h1>

                <div class="flex items-center justify-end mb-6">
                    <div class="flex items-center space-x-2">
                        <div
                            class="w-12 h-12 rounded-full overflow-hidden border-2 border-gray-300 dark:border-gray-500"
                        >
                            <img
                                src="https://avatars.githubusercontent.com/u/178928214?v=4"
                                alt="Foto de perfil"
                                class="w-full h-full object-cover"
                            />
                        </div>
                        <div class="text-right">
                            <h1 class="text-xl font-bold">
                                Hola, {user.nombre}
                            </h1>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">
                                {
                                    user.tipo == 1
                                        ? "Administrador"
                                        : user.tipo == 2
                                          ? "Vendedor"
                                          : "Usuario"
                                }
                            </p>
                        </div>
                    </div>
                </div>
                <!-- Contenido de tarjetas -->
                <div
                    class="grid grid-cols-1 md:grid-cols-1 lg:grid-cols-3 gap-6"
                >
                    <!-- Tarjeta Total Sales -->
                    <Card
                        title="Herramientas"
                        description="Manejo de datos de usuario"
                    >
                        <div class="flex space-x-4">
                            <div
                                id="add"
                                class="w-16 h-16 dark:bg-indigo-500 bg-sky-500 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                                id="openModalBtn"
                            >
                                <i class="fa-solid fa-plus text-4xl"></i>
                                <span class="text-xs">Agregar</span>
                            </div>
                        </div>
                        <div
                            id="editButton"
                            class="w-16 h-16 dark:bg-emerald-500 bg-lime-500 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                        >
                            <i class="fa-solid fa-pen text-4xl"></i>
                            <span class="text-xs">Editar</span>
                        </div>
                        <div
                            class="w-16 h-16 dark:bg-rose-500 bg-pink-600 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                        >
                            <i class="fa-solid fa-trash text-4xl"></i>
                            <span class="text-xs">Eliminar</span>
                        </div>
                        <div
                            class="w-16 h-16 dark:bg-amber-500 bg-orange-500 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                        >
                            <i class="fa-solid fa-chart-pie text-4xl"></i>
                            <span class="text-xs">Detalles</span>
                        </div>
                    </Card>
                </div>
                <Card title="Total de Clientes" description="Total"
                    ><i class="fa-solid fa-person"></i> 1</Card
                >
                <Card title="Clientes Recientes" description="El ultimo Mes"
                    ><i class="fa-solid fa-user-clock"></i> 1</Card
                >
            </div>

            <!-- Tabla de órdenes recientes -->
            <div
                class="mt-6 bg-white p-6 rounded-lg shadow-md overflow-x-auto dark:bg-gray-700"
            >
                <h2 class="text-xl font-semibold">
                    <i class="fa-solid fa-user-group"></i> Clientes
                </h2>
                <table class="min-w-full mt-4 table-auto dark:border-gray-700">
                    <thead class="dark:border-gray-700">
                        <tr>
                            <th class="px-4 py-2">ID Cliente</th>
                            <th class="px-4 py-2">Numero Cliente</th>
                            <th class="px-4 py-2">Tipo Cliente</th>
                            <th class="px-4 py-2">Direccion</th>
                            <th class="px-4 py2">Telefono</th>
                            <th class="px-4 py2">DUI</th>
                            <th class="px-4 py2">NIT</th>
                            <th class="px-4 py2">NCR</th>
                            <th class="px-4 py2">Giro</th>
                            <th class="px-4 py2">Fecha de Registro</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >00001</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >Juan</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >Consumidor Final</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >La Union</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >7824-9572</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >135679589-7</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >NULL</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >NULL</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >Compra</td
                            >
                            <td class="border px-4 py-2 dark:border-gray-500"
                                >10/23/2024</td
                            >
                        </tr>
                        <!-- Más filas según sea necesario -->
                    </tbody>
                </table>
            </div>
        </Sidebar>

        <!-- Main Content -->
    </div>
</Layout>
