---
export const prerender = false;
const data = Astro.locals;
import { verify, userinfo } from "@Lib/auth";
import Layout from "@Layouts/layout.astro";
import Sidebar from "@components/Sidebar.astro";
import Card from "@components/menu/Card.astro";
//Aqui va para conseguir el total de ventas
import Tabla from "@components/ventas/Tabla.astro";
import Modal from "@components/dialog.astro";

if ((await verify(data.token?.value)) == false) {
  return new Response(null, {
    status: 302,
    headers: {
      Location: "/",
    },
  });
}

const token = data.token?.value;

let res;
try {
  res = await userinfo(token);
} catch (error) {
  console.error("Error al obtener la información del usuario:", error);
  return new Response(null, {
    status: 500,
    statusText: "Internal Server Error",
  });
}
//Hay que cambiar esto
const user = res;
/*
const clients = (await clientes(token)) || [];
const total = (await totalclientes(token)) || { total: 0 };
*/
const tipoClienteMap = {
  1: "Natural",
  2: "Jurídico",
  // Agrega más tipos según sea necesario
};
---

<style>
  @import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css");
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background-color: #6c757d;
    border-radius: 4px;
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: #495057;
  }

  .scrollbar-custom {
    scrollbar-width: thin;
    scrollbar-color: #6c757d transparent;
  }
</style>
<Layout title="Panel de Control">
  <!-- height: max-content; -->
  <div
    class="flex flex-col md:flex-row bg-gray-100 dark:bg-gray-800 dark:text-white h-full"
  >
    <!-- Sidebar -->
    <br /><br />
    <Sidebar tipo={user.tipo_perfil}>
      <div class="flex-1 p-4 md:p-6 dark:bg-gray-800">
        <h1 class="text-3xl font-bold mb-6">
          <i class="fa-solid fa-cash-register"></i> Listado de Ventas
        </h1>

        <div class="flex items-center justify-end mb-6">
          <div class="flex items-center space-x-2">
            <div
              class="w-12 h-12 rounded-full overflow-hidden border-2 border-gray-300 dark:border-gray-500"
            >
              <img
                src={user.imagen ||
                  "https://avatars.githubusercontent.com/u/178928214?v=4"}
                alt="Foto de perfil"
                class="w-full h-full object-cover"
              />
            </div>
            <div class="text-right">
              <h1 class="text-xl font-bold">Hola, {user.nombre}</h1>
              <p class="text-gray-600 dark:text-gray-400 text-sm">
                {
                  user.tipo_perfil == 1
                    ? "Administrador"
                    : user.tipo_perfil == 2
                      ? "Vendedor"
                      : "Usuario"
                }
              </p>
            </div>
          </div>
        </div>
        <!-- Contenido de tarjetas -->
        <div class="grid grid-cols-1 gap-4 md:grid-cols-3">
          <Card title="Herramientas" description="Manejo de datos de ventas">
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-2">
              <div class="flex justify-center">
                <a
                  id="add"
                  class="w-14 h-14 sm:w-16 sm:h-16 lg:w-20 lg:h-20 dark:bg-indigo-500 bg-sky-500 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                  onclick="document.getElementById('Addmodal').showModal()"
                >
                  <i class="fa-solid fa-plus text-xl md:text-3xl"></i>
                  <span class="text-xs md:text-sm font-bold">Agregar</span>
                </a>
              </div>
              <div class="flex justify-center">
                <div
                  id="editButton"
                  class="w-14 h-14 sm:w-16 sm:h-16 lg:w-20 lg:h-20 dark:bg-emerald-500 bg-lime-500 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                  onclick="document.getElementById('Editmodal').showModal()"
                >
                  <i class="fa-solid fa-pen text-xl md:text-3xl"></i>
                  <span class="text-xs md:text-sm font-bold">Editar</span>
                </div>
              </div>
              <div class="flex justify-center">
                <div
                  class="w-14 h-14 sm:w-16 sm:h-16 lg:w-20 lg:h-20 dark:bg-amber-500 bg-orange-500 rounded-xl flex flex-col justify-center items-center text-gray-200 hover:scale-105 transition-transform duration-300 cursor-pointer"
                  onclick="document.getElementById('Detailmodal').showModal()"
                >
                  <i class="fa-solid fa-chart-pie text-xl md:text-3xl"></i>
                  <span class="text-xs md:text-sm font-bold">Detalles</span>
                </div>
              </div>
            </div>
          </Card>

          <Card title="Total de Ventas" description="Total"
            ><i class="fa-solid fa-money-check-dollar"></i> 0</Card
          >
          <Card title="Ventas Recientes" description="El ultimo Mes"
            ><i class="fa-solid fa-receipt"></i> 0
          </Card>
        </div>

        <!-- Tabla de órdenes recientes -->
        <div
          class="mt-6 bg-white p-6 rounded-lg shadow-md overflow-x-auto dark:bg-gray-700"
        >
          <h2 class="text-xl font-semibold">Ventas</h2><br />
        <!-- Contenedor principal para las tarjetas -->
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4">
  
  <!-- Tarjeta 1 -->
  <div class="max-w-xs rounded-lg shadow-lg bg-white dark:bg-gray-900 overflow-hidden">
    <div class="p-4 bg-gray-800 dark:bg-gray-200 text-center">
      <h2 class="text-xl font-semibold text-white dark:text-slate-900">Venta No: 1</h2>
    </div>
    <div class="p-4 text-gray-800 dark:text-gray-300">
      <p><strong>Número:</strong> 0001</p>
      <p><strong>Documento Fiscal:</strong> Factura</p>
      <p><strong>Correlativo:</strong> CCF</p>
      <p><strong>Fecha de Venta:</strong> 04/11/2024</p>
      <p><strong>Cliente:</strong> John Jarrison</p>
      <p><strong>Condición de Venta:</strong> Orden de compra</p>
      <p><strong>Método de Pago:</strong> Efectivo</p>
      <p><strong>Estado:</strong> Finalizado</p>
      <p><strong>Sumas:</strong> $1007.99</p>
      <p><strong>IVA:</strong> $131.04 (13%)</p>
      <p><strong>Total:</strong> $1,139.03</p>
      <p><strong>Vendedor:</strong> Juan</p>
    </div>
  </div>

  <!-- Tarjeta 2 -->
  <div class="max-w-xs rounded-lg shadow-lg bg-white dark:bg-gray-900 overflow-hidden">
    <div class="p-4 bg-gray-800 dark:bg-gray-200 text-center">
      <h2 class="text-xl font-semibold text-white dark:text-gray-900">Venta No: 2</h2>
    </div>
    <div class="p-4 text-gray-800 dark:text-gray-300">
      <p><strong>Número:</strong> 0002</p>
      <p><strong>Documento Fiscal:</strong> Factura</p>
      <p><strong>Correlativo:</strong> CCF</p>
      <p><strong>Fecha de Venta:</strong> 05/11/2024</p>
      <p><strong>Cliente:</strong> Alice Cooper</p>
      <p><strong>Condición de Venta:</strong> Crédito</p>
      <p><strong>Método de Pago:</strong> Transferencia</p>
      <p><strong>Estado:</strong> Pendiente</p>
      <p><strong>Sumas:</strong> $500.00</p>
      <p><strong>IVA:</strong> $65.00 (13%)</p>
      <p><strong>Total:</strong> $565.00</p>
      <p><strong>Vendedor:</strong> Marta</p>
    </div>
  </div>

  <!-- Tarjeta 3 -->
  <div class="max-w-xs rounded-lg shadow-lg bg-white dark:bg-gray-900 overflow-hidden">
    <div class="p-4 bg-gray-800 dark:bg-gray-200 text-center">
      <h2 class="text-xl font-semibold text-white dark:text-gray-900">Venta No: 3</h2>
    </div>
    <div class="p-4 text-gray-800 dark:text-gray-300">
      <p><strong>Número:</strong> 0003</p>
      <p><strong>Documento Fiscal:</strong> Factura</p>
      <p><strong>Correlativo:</strong> CCF</p>
      <p><strong>Fecha de Venta:</strong> 06/11/2024</p>
      <p><strong>Cliente:</strong> Bob Marley</p>
      <p><strong>Condición de Venta:</strong> Pago al contado</p>
      <p><strong>Método de Pago:</strong> Efectivo</p>
      <p><strong>Estado:</strong> Finalizado</p>
      <p><strong>Sumas:</strong> $700.00</p>
      <p><strong>IVA:</strong> $91.00 (13%)</p>
      <p><strong>Total:</strong> $791.00</p>
      <p><strong>Vendedor:</strong> Luis</p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const estados = document.querySelectorAll('p');
  
      estados.forEach(function (estado) {
        if (estado.innerHTML.includes("Estado:")) {
          const estadoTexto = estado.textContent.trim().split(":")[1].trim();
  
          if (estadoTexto.toLowerCase() === "finalizado") {
            estado.classList.add("text-green-500");
            estado.classList.remove("text-red-200");
          } else if (estadoTexto.toLowerCase() === "pendiente") {
            estado.classList.add("text-red-300");
            estado.classList.remove("text-green-300");
          }
        }
      });
    });
  </script>
  

  <!-- Tarjeta 4 -->
  <div class="max-w-xs rounded-lg shadow-lg bg-white dark:bg-gray-900 overflow-hidden">
    <div class="p-4 bg-gray-800 dark:bg-gray-200 text-center">
      <h2 class="text-xl font-semibold text-white dark:text-gray-900">Venta No: 4</h2>
    </div>
    <div class="p-4 text-gray-800 dark:text-gray-300">
      <p><strong>Número:</strong> 0004</p>
      <p><strong>Documento Fiscal:</strong> Factura</p>
      <p><strong>Correlativo:</strong> CCF</p>
      <p><strong>Fecha de Venta:</strong> 07/11/2024</p>
      <p><strong>Cliente:</strong> Jane Doe </p>
      <p><strong>Condición de Venta:</strong> Crédito</p>
      <p><strong>Método de Pago:</strong> Cheque</p>
      <p><strong>Estado:</strong> Pendiente</p>
      <p><strong>Sumas:</strong> $850.00</p>
      <p><strong>IVA:</strong> $110.50 (13%)</p>
      <p><strong>Total:</strong> $960.50</p>
      <p><strong>Vendedor:</strong> Ana</p>
    </div>
  </div>

</div>
        </div>

        <!-- Addmodal Content -->
        <!-- Modal hidden as defaul -->
        <!--AGREGAR -->
        <Modal id="Addmodal">
          <div
            class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-lg w-full p-6 animate-slideDown"
          >
            <h2
              class="text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100"
            >
              Agregar Venta
            </h2>

            <!-- Formulario -->
            <form name="agregar" method="POST" class="space-b-4">
              <label
                for="Documento"
                class="text-x1 text-gray-700 dark:text-gray-300"
                >Documento Fiscal</label
              >
              <input
                type="text"
                id="Documento"
                name="Documento"
                placeholder="Documento Fiscal"
                required
                class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
              />

              <label
                for="Correlativo"
                class="text-sm text-gray-700 dark:text-gray-300 mt-2"
                >Correlativo Documento Fiscal</label
              >
              <select
                id="Correlativo"
                name="Correlativo"
                required
                class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
              >
                <option value="1">Natural</option>
                <option value="2">Jurídico</option>
              </select>

              <label
                for="FechaVenta"
                class="text-sm text-gray-700 dark:text-gray-300 mt-2"
                >Fecha de Venta</label
              >
              <input
                id="FechaVenta"
                type="date"
                name="FechaVenta"
                required
                class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
              />
            </form>

            <label
              for="Cliente"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2">Venta</label
            >
            <input
              type="text"
              id="Cliente"
              name="Cliente"
              placeholder="Nombre del Cliente"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />

            <label
              for="CondicionVenta"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2"
              >Condicion de venta</label
            >
            <input
              type="text"
              id="CondicionVenta"
              name="CondicionVenta"
              placeholder="Condicion de venta"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />

            <label
              for="MetodoPago"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2"
              >Metodo de Pago</label
            >
            <input
              type="text"
              id="MetodoPago"
              name="MetodoPago"
              placeholder="Metodo de pago"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />

            <label
              for="Estado"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2"
              >Estado</label
            >
            <input
              type="text"
              id="Estado"
              name="Estado"
              placeholder="Estado de la venta"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />

            <label
              for="Sumas"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2">Sumas</label
            >
            <input
              type="text"
              id="Sumas"
              name="Sumas"
              placeholder="Sumas"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />
            <label
              for="IVA"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2">IVA</label
            >
            <input
              type="text"
              id="IVA"
              name="IVA"
              placeholder="Iva 13%"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />
            <label
              for="Total"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2">Total</label
            >
            <input
              type="text"
              id="Total"
              name="Total"
              placeholder="Total de la venta"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />
            <label
              for="Vendedor"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2"
              >Vendedor</label
            >
            <input
              type="text"
              id="Vendedor"
              name="Vendedor"
              placeholder="Vendedor"
              required
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />
            <!-- Botones -->
            <div class="flex justify-end space-x-4">
              <button
                type="button"
                class="btn btn-cancel bg-gray-500 text-white px-4 py-2 rounded-md"
                onclick="document.getElementById('Addmodal').close()"
              >
                Cancelar
              </button>
              <button
                type="button"
                id="addcl"
                class="btn btn-submit bg-blue-500 text-white px-4 py-2 rounded-md"
              >
                Enviar
              </button>
            </div>
          </div>
        </Modal>
      </div>
      <!--EDITAR -->
      <Modal id="Editmodal">
        <div
          class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-lg w-full p-6 animate-slideDown"
        >
          <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100">
            Editar Venta
          </h2>

          <form name="editar" method="POST" class="space-b-4">
            <label
              for="Documento"
              class="text-x1 text-gray-700 dark:text-gray-300"
              >Documento Fiscal</label
            >
            <input
              type="text"
              id="Documento"
              name="Documento"
              placeholder="Documento Fiscal"
              required
              disabled
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />

            <label
              for="Correlativo"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2"
              >Correlativo Documento Fiscal</label
            >
            <select
              id="Correlativo"
              name="Correlativo"
              required
              disabled
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            >
              <option value="1">Natural</option>
              <option value="2">Jurídico</option>
            </select>

            <label
              for="FechaVenta"
              class="text-sm text-gray-700 dark:text-gray-300 mt-2"
              >Fecha de Venta</label
            >
            <input
              id="FechaVenta"
              type="date"
              name="FechaVenta"
              required
              disabled
              class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
            />
          </form>

          <label
            for="Cliente"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2">Cliente</label
          >
          <input
            type="text"
            id="Cliente"
            name="Cliente"
            placeholder="Nombre del Cliente"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />

          <label
            for="CondicionVenta"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2"
            >Condicion de venta</label
          >
          <input
            type="text"
            id="CondicionVenta"
            name="CondicionVenta"
            placeholder="Condicion de venta"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />

          <label
            for="MetodoPago"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2"
            >Metodo de Pago</label
          >
          <input
            type="text"
            id="MetodoPago"
            name="MetodoPago"
            placeholder="Metodo de pago"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />

          <label
            for="Estado"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2">Estado</label
          >
          <input
            type="text"
            id="Estado"
            name="Estado"
            placeholder="Estado de la venta"
            required
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />

          <label
            for="Sumas"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2">Sumas</label
          >
          <input
            type="text"
            id="Sumas"
            name="Sumas"
            placeholder="Sumas"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />
          <label for="IVA" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
            >IVA</label
          >
          <input
            type="text"
            id="IVA"
            name="IVA"
            placeholder="Iva 13%"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />
          <label
            for="Total"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2">Total</label
          >
          <input
            type="text"
            id="Total"
            name="Total"
            placeholder="Total de la venta"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />
          <label
            for="Vendedor"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2"
            >Vendedor</label
          >
          <input
            type="text"
            id="Vendedor"
            name="Vendedor"
            placeholder="Vendedor"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />
          <!-- Botones -->
          <div class="flex justify-end space-x-4">
            <button
              type="button"
              class="btn btn-cancel bg-gray-500 text-white px-4 py-2 rounded-md"
              onclick="document.getElementById('Editmodal').close()"
            >
              Cancelar
            </button>
            <button
              type="button"
              onclick="editcliente()"
              class="btn btn-submit bg-blue-500 text-white px-4 py-2 rounded-md"
            >
              Enviar
            </button>
          </div>
        </div>
      </Modal>
    </Sidebar>
    <!--Eliminar -->
    <Modal id="Deletemodal">
      <div
        class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-lg w-full p-6 animate-slideDown"
      >
        <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100">
          Eliminar Venta
        </h2>

        <!-- Formulario -->

        <form name="detalles" method="POST" class="space-b-4">
          <label
            for="Documento"
            class="text-x1 text-gray-700 dark:text-gray-300"
            >Documento Fiscal</label
          >
          <input
            type="text"
            id="Documento"
            name="Documento"
            placeholder="Documento Fiscal"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />

          <label
            for="Correlativo"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2"
            >Correlativo Documento Fiscal</label
          >
          <select
            id="Correlativo"
            name="Correlativo"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          >
            <option value="1">Natural</option>
            <option value="2">Jurídico</option>
          </select>

          <label
            for="FechaVenta"
            class="text-sm text-gray-700 dark:text-gray-300 mt-2"
            >Fecha de Venta</label
          >
          <input
            id="FechaVenta"
            type="date"
            name="FechaVenta"
            required
            disabled
            class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
          />
        </form>

        <label
          for="Cliente"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2">Cliente</label
        >
        <input
          type="text"
          id="Cliente"
          name="Cliente"
          placeholder="Nombre del Cliente"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label
          for="CondicionVenta"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >Condicion de venta</label
        >
        <input
          type="text"
          id="CondicionVenta"
          name="CondicionVenta"
          placeholder="Condicion de venta"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label
          for="MetodoPago"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >Metodo de Pago</label
        >
        <input
          type="text"
          id="MetodoPago"
          name="MetodoPago"
          placeholder="Metodo de pago"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label
          for="Estado"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2">Estado</label
        >
        <input
          type="text"
          id="Estado"
          name="Estado"
          placeholder="Estado de la venta"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label for="Sumas" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >Sumas</label
        >
        <input
          type="text"
          id="Sumas"
          name="Sumas"
          placeholder="Sumas"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />
        <label for="IVA" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >IVA</label
        >
        <input
          type="text"
          id="IVA"
          name="IVA"
          placeholder="Iva 13%"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />
        <label for="Total" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >Total</label
        >
        <input
          type="text"
          id="Total"
          name="Total"
          placeholder="Total de la venta"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />
        <label
          for="Vendedor"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2">Vendedor</label
        >
        <input
          type="text"
          id="Vendedor"
          name="Vendedor"
          placeholder="Vendedor"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />
        <!-- Botones -->
        <div class="flex justify-end space-x-4">
          <button
            type="button"
            class="btn btn-cancel bg-gray-500 text-white px-4 py-2 rounded-md"
            onclick="document.getElementById('Deletemodal').close()"
          >
            Cancelar
          </button>
          <button
            type="button"
            onclick="deletecliente()"
            class="btn btn-submit bg-blue-500 text-white px-4 py-2 rounded-md"
          >
            Enviar
          </button>
        </div>
      </div>
    </Modal>
  </div>
  <!--Detalles-->
  <Modal id="Detailmodal">
    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-lg w-full p-6 animate-slideDown"
    >
      <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100">
        Detalle Venta
      </h2>

      <!-- Formulario -->
      <form name="agregar" method="POST" class="space-b-4">
        <label for="nombre" class="text-x1 text-gray-700 dark:text-gray-300"
          >Nombre</label
        >
        <input
          type="text"
          id="nombre"
          name="nombre"
          placeholder="Nombre"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label for="tipo" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >Tipo Cliente</label
        >
        <select
          id="tipo"
          name="tipo"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        >
          <option value="1">Natural</option>
          <option value="2">Jurídico</option>
        </select>

        <label
          for="Direccion"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2">Dirección</label
        >
        <textarea
          id="Direccion"
          name="Direccion"
          placeholder="Dirección"
          required
          disabled
          rows="2"
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        ></textarea>

        <label
          for="Telefono"
          class="text-sm text-gray-700 dark:text-gray-300 mt-2">Teléfono</label
        >
        <input
          type="text"
          id="Telefono"
          name="Telefono"
          placeholder="Teléfono"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label for="Dui" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >DUI</label
        >
        <input
          type="text"
          id="Dui"
          name="Dui"
          placeholder="DUI"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label for="Nit" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >NIT</label
        >
        <input
          type="text"
          id="Nit"
          name="Nit"
          placeholder="NIT"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label for="Ncr" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >NCR</label
        >
        <input
          type="text"
          id="Ncr"
          name="Ncr"
          placeholder="NCR"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />

        <label for="Giro" class="text-sm text-gray-700 dark:text-gray-300 mt-2"
          >Giro</label
        >
        <input
          type="text"
          id="Giro"
          name="Giro"
          placeholder="Giro"
          required
          disabled
          class="mb-5 form-field w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"
        />
        <!-- Botones -->
        <div class="flex justify-end space-x-4">
          <button
            type="button"
            class="btn btn-cancel bg-gray-500 text-white px-4 py-2 rounded-md"
            onclick="document.getElementById('Detailmodal').close()"
          >
            Cancelar
          </button>
          <button
            type="button"
            onclick="detailcliente()"
            class="btn btn-submit bg-blue-500 text-white px-4 py-2 rounded-md"
          >
            Enviar
          </button>
        </div>
      </form>
    </div>
  </Modal>
</Layout>

<script type="module">
  const addcl = document.getElementById("addcl");
  addcl.addEventListener("click", addcliente);

  function addcliente() {
    const formcliente = document.getElementsByName("agregar")[0];
    // Verifica que todo esté correcto
    console.log(formcliente);
    const nombre = formcliente.Nombre.value;
    const tipo = formcliente.tipo.value;
    const direccion = formcliente.Direccion.value;
    const telefono = formcliente.Telefono.value;
    const dui = formcliente.Dui.value;
    const nit = formcliente.Nit.value;
    const nrc = formcliente.Nrc.value;
    const giro = formcliente.Giro.value;
    //get token from cookie
    const token = document.cookie
      .split("; ")
      .find((row) => row.startsWith("token"))
      .split("=")[1];
    // Envía los datos al servidor
    fetch("http://localhost:8000/clientes/agregar", {
      method: "POST",
      headers: {
        Authorization: `Bearer ${token}`,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        nombre: nombre,
        tipo_cliente: tipo,
        direccion: direccion,
        telefono: telefono,
        dui: dui,
        nit: nit,
        nrc: nrc,
        giro: giro,
        fecha_registro: new Date().toISOString(),
      }),
    }).then((res) => {
      if (res.ok) {
        alert("Cliente agregado correctamente");
        location.reload();
      } else {
        alert("Error al agregar el cliente");
      }
    });
  }
</script>
